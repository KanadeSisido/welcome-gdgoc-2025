<!DOCTYPE html>
<html lang="ja">
	<head>
		<meta charset="UTF-8" />
		<title>自動エスケープ付き デモ</title>

		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}
		</style>
		<!-- コードブロック用 CSS -->
		<style>
			.codeblock-wrapper {
				display: flex;
				flex-direction: column;

				border-radius: 10px;
				border: 1px solid #ccc;
			}
			.codeblock-header {
				height: 40px;
				display: flex;
				flex-direction: row;
			}
			.codeblock-header p {
				display: flex;
				width: 50%;
				margin-left: 20px;
				align-items: center;
			}

			.codeblock {
				display: flex;
			}

			.codeblock pre {
				background: #f4f4f4;
				padding: 1rem;
				border: 1px solid #ccc;
				width: 50%;
				height: 250px;
				overflow-x: auto;
				white-space: pre-wrap;
				margin: 0;
				border-radius: 0px 0px 0px 10px;
			}

			.codeblock iframe {
				width: 50%;
				height: 250px;
				border: 1px solid #ccc;
				border-radius: 0px 0px 10px 0px;
			}

			textarea.source {
				display: none;
			}
		</style>

		<!-- Warning用 CSS -->
		<style></style>
	</head>
	<body>
		<h1>HTML + CSS デモ（非エスケープで楽々）</h1>

		<!-- エスケープせず生で書ける -->
		<div class="codeblock-wrapper">
			<div class="codeblock-header">
				<p>コード</p>
				<p>結果</p>
			</div>
			<div class="codeblock">
				<textarea class="source">
<!DOCTYPE html>
<html>
<head>
</head>
<body>
	<h1>こんにちは！</h1>
	<p>
		Lorem, ipsum dolor sit amet consectetur adipisicing elit.
		Perspiciatis, illum dolor. Aspernatur magni reiciendis labore totam et
		rem, quae voluptates accusantium quas facere sint voluptas cupiditate
		maxime nemo inventore numquam?
	</p>
	<a href="https://x.com/japan">私のXプロフィールへ</a>
</body>
</html>
                </textarea
				>
				<pre><code></code></pre>

				<iframe></iframe>
			</div>
		</div>

		<script>
			// エスケープ関数
			function escapeHTML(str) {
				return str
					.replace(/&/g, "&amp;")
					.replace(/</g, "&lt;")
					.replace(/>/g, "&gt;");
			}

			document.querySelectorAll(".codeblock").forEach((block) => {
				const source = block.querySelector(".source").value.trim();
				const code = block.querySelector("code");
				const iframe = block.querySelector("iframe");

				// 表示用コードにエスケープして表示
				code.innerHTML = escapeHTML(source);

				// 実行用iframeにそのまま挿入
				const doc = iframe.contentWindow.document;
				doc.open();
				doc.write(source);
				doc.close();
			});
		</script>
	</body>
</html>
